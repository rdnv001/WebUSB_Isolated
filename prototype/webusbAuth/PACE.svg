<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="559" height="929"><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="559" height="929"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.51971534472654" y="22.6179738" text-anchor="start" dominant-baseline="alphabetic">PACE-ECDH-GM-AES-CBC-CMAC-128 </text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 88.511670804 L 67.8539214 929.9002961640001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.2587514769531 88.511670804 L 491.2587514769531 929.9002961640001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 36.021510601984374 47.799317964000004 L 99.68633219801563 47.799317964000004 L 99.68633219801563 88.511670804 L 36.021510601984374 88.511670804 L 36.021510601984374 47.799317964000004 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="52.38184498398438" y="73.43302160400002" text-anchor="start" dominant-baseline="alphabetic">PCD</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 462.27815494895697 47.799317964000004 L 520.2393480049492 47.799317964000004 L 520.2393480049492 88.511670804 L 462.27815494895697 88.511670804 L 462.27815494895697 47.799317964000004 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="478.638489330957" y="73.43302160400002" text-anchor="start" dominant-baseline="alphabetic">ICC</text></g></g><g><g><g><rect fill="white" stroke="none" x="108.79075487878903" y="118.668969204" width="242.37277688890626" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="108.79075487878903" y="133.747618404" width="341.531163119375" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="108.79075487878903" y="148.826267604" width="163.09380044847657" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.05255225878904" y="132.239753484" text-anchor="start" dominant-baseline="alphabetic">manage security environment (MSE)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.05255225878904" y="147.318402684" text-anchor="start" dominant-baseline="alphabetic">set authentication for mutual authentication (Set AT)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.05255225878904" y="162.397051884" text-anchor="start" dominant-baseline="alphabetic">(pace_oid,CHAT,pw_ref)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 168.42851156400002 L 488.7456432769531 168.42851156400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(491.2587514769531,168.42851156400002) translate(-491.2587514769531,-168.42851156400002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 478.6932104769531 162.14574106400002 L 491.2587514769531 168.42851156400002 L 478.6932104769531 174.71128206400002 Z"/></g></g><g><g><rect fill="white" stroke="none" x="100.3174577596484" y="191.046485364" width="204.93063821703126" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="100.3174577596484" y="206.125134564" width="358.47775735765623" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="102.57925513964841" y="204.617269644" text-anchor="start" dominant-baseline="alphabetic">general authenticate (GA) start</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="102.57925513964841" y="219.695918844" text-anchor="start" dominant-baseline="alphabetic">(command: 0x7C 0x00 ~Dynamic Authentication Data)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 225.72737852400002 L 488.7456432769531 225.72737852400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(491.2587514769531,225.72737852400002) translate(-491.2587514769531,-225.72737852400002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 478.6932104769531 219.44460802400002 L 491.2587514769531 225.72737852400002 L 478.6932104769531 232.01014902400001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="223.11006792810545" y="248.34535232400003" width="112.89253702074218" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="225.37186530810544" y="261.91613660400003" text-anchor="start" dominant-baseline="alphabetic">encrypted nonce</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.2587514769531 267.94759628400004 L 70.36702960000001 267.94759628400004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(67.8539214,267.94759628400004) translate(-67.8539214,-267.94759628400004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 80.4194624 261.664825784 L 67.8539214 267.94759628400004 L 80.4194624 274.23036678400007 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 307.90601666400005 L 75.393246 307.90601666400005 M 75.393246 290.56557008400006 L 468.3186334377343 290.56557008400006 L 468.3186334377343 325.24646324400004 L 75.393246 325.24646324400004 L 75.393246 290.56557008400006" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.50335487999996" y="311.6756789640001" text-anchor="start" dominant-baseline="alphabetic">decrypt(AES-CBC,encrypted nonce,password)=nonce</text></g><g><g><rect fill="white" stroke="none" x="227.19993456628904" y="388.57678988400005" width="104.712803744375" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="229.46173194628904" y="402.14757416400005" text-anchor="start" dominant-baseline="alphabetic">PCD public key</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 408.17903384400006 L 488.7456432769531 408.17903384400006" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(491.2587514769531,408.17903384400006) translate(-491.2587514769531,-408.17903384400006)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 478.6932104769531 401.89626334400003 L 491.2587514769531 408.17903384400006 L 478.6932104769531 414.4618043440001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="230.05174883630858" y="430.7970076440001" width="99.00917520433593" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="232.31354621630857" y="444.36779192400013" text-anchor="start" dominant-baseline="alphabetic">ICC public key</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.2587514769531 450.3992516040001 L 70.36702960000001 450.3992516040001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(67.8539214,450.3992516040001) translate(-67.8539214,-450.3992516040001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 80.4194624 444.11648110400006 L 67.8539214 450.3992516040001 L 80.4194624 456.6820221040001 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.283137120000006 495.6351992040002 L 504.8295357569531 495.6351992040002 L 504.8295357569531 530.3160923640002 L 54.283137120000006 530.3160923640002 L 54.283137120000006 495.6351992040002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="182.80218604785154" y="516.7453080840002" text-anchor="start" dominant-baseline="alphabetic">(p256r1,nonce,P)=D_Mapped</text></g><g><g><rect fill="white" stroke="none" x="221.08839281824217" y="593.6464190040001" width="116.93588724046874" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="223.35019019824216" y="607.2172032840001" text-anchor="start" dominant-baseline="alphabetic">PCD public key 2</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 613.2486629640001 L 488.7456432769531 613.2486629640001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(491.2587514769531,613.2486629640001) translate(-491.2587514769531,-613.2486629640001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 478.6932104769531 606.9658924640001 L 491.2587514769531 613.2486629640001 L 478.6932104769531 619.5314334640001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="223.9402070882617" y="635.8666367640001" width="111.23225870042968" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="226.2020044682617" y="649.4374210440001" text-anchor="start" dominant-baseline="alphabetic">ICC public key 2</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.2587514769531 655.4688807240001 L 70.36702960000001 655.4688807240001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(67.8539214,655.4688807240001) translate(-67.8539214,-655.4688807240001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 80.4194624 649.1861102240001 L 67.8539214 655.4688807240001 L 80.4194624 661.751651224 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.283137120000006 700.7048283240001 L 504.8295357569531 700.7048283240001 L 504.8295357569531 735.3857214840001 L 54.283137120000006 735.3857214840001 L 54.283137120000006 700.7048283240001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="219.8865061162109" y="721.8149372040001" text-anchor="start" dominant-baseline="alphabetic">(K)=K_enc,K_mac</text></g><g><g><rect fill="white" stroke="none" x="125.19657763269528" y="758.0036952840001" width="308.7195176115625" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="127.45837501269529" y="771.5744795640001" text-anchor="start" dominant-baseline="alphabetic">(AES-CMAC,K_mac,ICC public key 2)=T_PCD</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 67.8539214 777.6059392440001 L 488.7456432769531 777.6059392440001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(491.2587514769531,777.6059392440001) translate(-491.2587514769531,-777.6059392440001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 478.6932104769531 771.3231687440001 L 491.2587514769531 777.6059392440001 L 478.6932104769531 783.888709744 Z"/></g></g><g><g><rect fill="white" stroke="none" x="85.69698961999997" y="800.223913044" width="387.7186936369531" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="87.95878699999997" y="813.794697324" text-anchor="start" dominant-baseline="alphabetic">(AES-CMAC,K_mac,PCD public key 2)=T_ICC (,car1,car2)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.2587514769531 819.826157004 L 70.36702960000001 819.826157004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(67.8539214,819.826157004) translate(-67.8539214,-819.826157004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 80.4194624 813.5433865040001 L 67.8539214 819.826157004 L 80.4194624 826.108927504 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 54.283137120000006 842.4441308040001 L 504.8295357569531 842.4441308040001 L 504.8295357569531 877.1250239640001 L 54.283137120000006 877.1250239640001 L 54.283137120000006 842.4441308040001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="87.73007301074216" y="863.5542396840001" text-anchor="start" dominant-baseline="alphabetic">verifyToken(AES-CMAC,K_mac,T_other,other public key 2)</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 347.86443704400006 L 544.0340236769531 347.86443704400006 L 544.0340236769531 473.0172254040001 L 15.078649200000001 473.0172254040001 L 15.078649200000001 347.86443704400006 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 347.86443704400006 L 15.078649200000001 365.95881608400003 L 424.6076211839844 365.95881608400003 L 433.6548107039844 356.9116265640001 L 433.6548107039844 347.86443704400006 L 15.078649200000001 347.86443704400006" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="30.157298400000002" y="359.927356404" text-anchor="start" dominant-baseline="alphabetic">Map Nonce EC Diffie-Hellmann key exchange (p256r1)=shared key P</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 552.9340661640001 L 544.0340236769531 552.9340661640001 L 544.0340236769531 678.086854524 L 15.078649200000001 678.086854524 L 15.078649200000001 552.9340661640001 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.078649200000001 552.9340661640001 L 15.078649200000001 571.0284452040001 L 425.2541971117188 571.0284452040001 L 434.3013866317188 561.9812556840001 L 434.3013866317188 552.9340661640001 L 15.078649200000001 552.9340661640001" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="30.157298400000002" y="564.9969855240001" text-anchor="start" dominant-baseline="alphabetic">EC Diffie-Hellmann key exchange (p256r1, D_Mapped)=shared key K</text></g></g><g/><g/></g></svg>